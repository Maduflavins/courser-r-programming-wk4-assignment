"0","rankhospital <- function(state, outcome, num){"
"0","  # Read the file outcome-of-care-measures.csv"
"0","    df <- read.csv(""./outcomes.csv"", colClasses = c(Hospital.30.Day.Death..Mortality..Rates.from.Heart.Attack = ""character"", "
"0","        Hospital.30.Day.Death..Mortality..Rates.from.Heart.Failure = ""character"", "
"0","        Hospital.30.Day.Death..Mortality..Rates.from.Pneumonia = ""character"", "
"0","        Hospital.Name = ""character""))"
"0","    "
"0","    df[, 11] <- suppressWarnings(as.numeric(df[, 11]))"
"0","    df[, 17] <- suppressWarnings(as.numeric(df[, 17]))"
"0","    df[, 23] <- suppressWarnings(as.numeric(df[, 23]))"
"0","    "
"0","    #validate supplied state and outcome"
"0","    "
"0","    outcomes <- c(""heart attack"", ""heart failure"", ""pneumonia"")"
"0","    "
"0","    if (!(state %in% df$State)) {"
"0","        stop(""invalid state"")"
"0","    }"
"0","    "
"0","    if (!(outcome %in% outcomes)) {"
"0","        stop(""invalid outcome"")"
"0","    }"
"0","    "
"0","    "
"0","    if (outcome == ""heart attack"") {"
"0","        df2 <- df[df$State == state, c(2, 11)]"
"0","        names(df2)[2] <- ""Rate"""
"0","    }"
"0","    "
"0","    if (outcome == ""heart failure"") {"
"0","        df2 <- df[df$State == state, c(2, 17)]"
"0","        names(df2)[2] <- ""Rate"""
"0","    }"
"0","    "
"0","    "
"0","    if (outcome == ""pneumonia"") {"
"0","        df2 <- df[df$State == state, c(2, 23)]"
"0","        names(df2)[2] <- ""Rate"""
"0","    }"
"0","    # Remove rows where Ratings are not known."
"0","    df2 <- df2[!is.na(df2$Rate), ]"
"0","    # Order the dataframe by Names to help in Ranking"
"0","    df2 <- df2[order(df2[1]), ]"
"0","    # head(df1) tail(df1)"
"0","    "
"0","    # Set Rank"
"0","    df2$rank <- rank(df2$Rate, ties.method = ""first"")"
"0","    "
"0","    # Return the values based on data provided"
"0","    if (num == ""best"") {"
"0","        return(df2[df2$rank == min(df2$rank), 1])"
"0","    } else if (num == ""worst"") {"
"0","        return(df2[df2$rank == max(df2$rank), 1])"
"0","    } else if ((num <= max(df2$rank)) | (num >= min(df2$rank))) {"
"0","        return(df2[df2$rank == num, 1])"
"0","    } else if ((num > max(df2$rank)) | (num < min(df2$rank))) {"
"0","        NA"
"0","    }"
"0","}"
